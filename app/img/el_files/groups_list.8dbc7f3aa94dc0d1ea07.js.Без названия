!function(r){function s(s){for(var t,c,n=s[0],l=s[1],a=s[2],h=0,d=[];h<n.length;h++)c=n[h],o[c]&&d.push(o[c][0]),o[c]=0;for(t in l)Object.prototype.hasOwnProperty.call(l,t)&&(r[t]=l[t]);for(u&&u(s);d.length;)d.shift()();return i.push.apply(i,a||[]),e()}function e(){for(var r,s=0;s<i.length;s++){for(var e=i[s],t=!0,n=1;n<e.length;n++){var l=e[n];0!==o[l]&&(t=!1)}t&&(i.splice(s--,1),r=c(c.s=e[0]))}return r}var t={},o={"web/groups_list":0},i=[];function c(s){if(t[s])return t[s].exports;var e=t[s]={i:s,l:!1,exports:{}};return r[s].call(e.exports,e,e.exports,c),e.l=!0,e.exports}c.m=r,c.c=t,c.d=function(r,s,e){c.o(r,s)||Object.defineProperty(r,s,{enumerable:!0,get:e})},c.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},c.t=function(r,s){if(1&s&&(r=c(r)),8&s)return r;if(4&s&&"object"==typeof r&&r&&r.__esModule)return r;var e=Object.create(null);if(c.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:r}),2&s&&"string"!=typeof r)for(var t in r)c.d(e,t,function(s){return r[s]}.bind(null,t));return e},c.n=function(r){var s=r&&r.__esModule?function(){return r.default}:function(){return r};return c.d(s,"a",s),s},c.o=function(r,s){return Object.prototype.hasOwnProperty.call(r,s)},c.p="";var n=window.webpackJsonp=window.webpackJsonp||[],l=n.push.bind(n);n.push=s,n=n.slice();for(var a=0;a<n.length;a++)s(n[a]);var u=l;i.push([95,"bundles/common"]),e()}({"4HDr":function(r,s,e){"use strict";e.r(s);var t=e("XzvV");window.GroupsList={rand:function(){return Math.floor(1e4*Math.random())},toggleFave:function(r,s,e,t){var o=this,i=parseInt(r.getAttribute("data-value"))?1:0;ajax.post("fave.php",{act:i?"a_delete_group":"a_add_group",gid:s,hash:e},{onDone:function(e){val(r,e),r.setAttribute("data-value",1-i),o.updateGroupField(s,12,1-i)},showProgress:lockActionsMenuItem.pbind(r),hideProgress:unlockActionsMenuItem.pbind(r)}),cancelEvent(t)},toggleSubscription:function(r,s,e,t){var o=this,i=parseInt(r.getAttribute("data-value"))?1:0;ajax.post("al_wall.php",{act:"a_toggle_posts_subscription",subscribe:i?0:1,oid:-s,hash:e},{onDone:function(e){val(r,e),r.setAttribute("data-value",1-i),o.updateGroupField(s,13,1-i)},showProgress:lockActionsMenuItem.pbind(r),hideProgress:unlockActionsMenuItem.pbind(r)}),cancelEvent(t)},subscribe:function(r,s,e,t){var o=hasClass(r,"flat_button");if(!(o&&buttonLocked(r)||actionsMenuItemLocked(r))){var i=o?hasClass(r,"secondary"):!cur.scrollList.deleted[s];!function t(c){ajax.post("al_groups.php",{act:i?"list_leave":"list_enter",gid:s,hash:e,confirm:c},{showProgress:(o?lockButton:lockActionsMenuItem).pbind(r),hideProgress:(o?unlockButton:unlockActionsMenuItem).pbind(r),onDone:function(e,c,n){if(c){var l=showFastBox(getLang("global_warning"),c,getLang("group_leave_group"),function(){l.hide(),t(1)},getLang("global_cancel"));return!0}if(val(r,e),cur.scrollList.deleted[s]=i,o)toggleClass(r,"secondary",!i);else{var a=domClosest("_gl_row",r);toggleClass(a,"deleted",i),n&&addClass(a,"closed")}},onFail:function(r){setTimeout(showFastBox(getLang("global_error"),r).hide,3e3)}})}()}},updateGroupField:function(r,s,e){cur.scrollList&&cur.scrollList.lists&&each(cur.scrollList.lists,function(){if(this&&this.length)for(var t=0,o=this.length;t<o;++t)if(this[t][2]==r){this[t][s]=e;break}})},enter:function(r,s,e,t,o){var i=this;if(cur.invSwitching)return setTimeout(function(){return i.enter(r,s,e,t,o)},100),!1;var c=void 0,n=void 0,l=cur.scrollList.tab;"button"!=r.tagName.toLowerCase()?(r.backhtml||(r.backhtml=r.innerHTML),c=function(){var s=getSize(r)[0];r.innerHTML='<span class="progress_inline"></span>',setStyle(domFC(r),{width:s})},n=function(){r.innerHTML=r.backhtml}):(c=lockButton.pbind(r),n=unlockButton.pbind(r));var a=this.rand(),u=this.rand();cur.scrollList[a]=u,cur.invSwitching=!0,ajax.post("/al_groups.php",{act:"enter",gid:s,hash:e,context:"2"+(t?"_"+t:"")},{onDone:function(r,e){if(cur.invSwitching=!1,cur.scrollList&&cur.scrollList[a]==u){var c=cur.scrollList.lists[l],n=o?5:1;if("unsure"==t?n=o?5:3:"decline"==t?n=o?-3:-1:"undecided"==t&&(n=4),c&&"loading"!=c&&"update"!=c)for(var h=0,d=c.length;h<d;++h)c[h][2]==s&&(c[h][1]=n);else cur.scrollList.processed[l][s]=n;if(r&&cur.scrollList.lists.groups){var p=cur.scrollList.lists.groups;if("join"!=t&&"unsure"!=t&&t){if("undecided"==t)for(var g in p)p[g][2]==r[2]&&(p.splice(g,1),cur.scrollList.counts.groups--)}else p.unshift(r),cur.scrollList.counts.groups++;i.updateIndexer(p),i.showMore(!0)}TopNotifier&&!TopNotifier.shown()&&TopNotifier.invalidate();var f=ge("gl_inv"+s),v=f&&geByClass1("group_row_status",f);f&&(v.basehtml=v.innerHTML,v.innerHTML=e)}},onFail:function(r){if(r)return setTimeout(showFastBox(getLang("global_error"),r).hide,3e3),!0},showProgress:c,hideProgress:n})},leave:function(r,s,e,t){var o=this;if(cur.invSwitching)return setTimeout(function(){return o.leave(r,s,e,t)},100),!1;if(!r.firstChild||"progress_inline"!=r.firstChild.className){var i=this.rand(),c=this.rand(),n=cur.scrollList.tab,l=void 0,a=void 0;cur.scrollList[i]=c,"button"!=r.tagName.toLowerCase()?(r.backhtml||(r.backhtml=r.innerHTML),l=function(){var s=getSize(r)[0];r.innerHTML='<span class="progress_inline"></span>',setStyle(domFC(r),{width:s})},a=function(){r.innerHTML=r.backhtml}):(l=lockButton.pbind(r),a=unlockButton.pbind(r)),cur.invSwitching=!0,ajax.post("/al_groups.php",{act:"leave",gid:s,hash:e,context:2},{onDone:function(r,e){if(cur.invSwitching=!1,cur.scrollList&&cur.scrollList[i]==c){var t=cur.scrollList.lists[n];if(t&&"loading"!=t&&"update"!=t)for(var o=0,l=t.length;o<l;++o)t[o][2]==s&&(t[o][1]=-1);else cur.scrollList.processed[n][s]=-1;TopNotifier&&!TopNotifier.shown()&&TopNotifier.invalidate();var a=ge("gl_inv"+s),u=a&&geByClass1("group_row_status",a);a&&(u.basehtml=u.innerHTML,u.innerHTML=e)}},showProgress:l,hideProgress:a})}},spam:function(r,s,e){if(!domFC(r)||"progress_inline"!=domFC(r)){var t=this.rand(),o=this.rand(),i=cur.scrollList.tab;cur.scrollList[t]=o,ajax.post("/al_groups.php",{act:"spam",gid:s,hash:e,context:1},{onDone:function(r){if(cur.scrollList&&cur.scrollList[t]==o){var e=cur.scrollList.lists[i];if(e&&"loading"!=e&&"update"!=e)for(var c=0,n=e.length;c<n;++c)e[c][2]==s&&(e[c][1]=-2);else cur.scrollList.processed[i][s]=-2;var l=ge("gl_inv"+s),a=l&&geByClass1("group_row_status",l);l&&(a.innerHTML=r)}},showProgress:function(){r.oldhtml=r.innerHTML;var s=getSize(r)[0];r.innerHTML='<span class="progress_inline"></span>',setStyle(domFC(r),{width:s})},hideProgress:function(){r.innerHTML=r.oldhtml}})}},cancel:function(r,s,e){var t=this;if(!domFC(r)||"progress_inline"!=domFC(r).className){var o=this.rand(),i=this.rand(),c=cur.scrollList.tab;cur.scrollList[o]=i,ajax.post("/al_groups.php",{act:"cancel",gid:s,hash:e,context:1},{onDone:function(){if(cur.scrollList&&cur.scrollList[o]==i){var r=cur.scrollList.lists[c];if(r&&"loading"!=r&&"update"!=r){for(var e in r)r[e][2]==s&&(r.splice(e,1),cur.scrollList.counts.groups--);t.updateIndexer(r),t.showMore(!0)}else cur.scrollList.processed[c][s]=0;var n=ge("gl_inv"+s),l=n&&geByClass1("group_row_status",n);n&&l&&l.basehtml&&(l.innerHTML=l.basehtml)}},showProgress:function(){r.oldhtml=r.innerHTML;var s=getSize(r)[0];r.innerHTML='<span class="progress_inline"></span>',setStyle(domFC(r),{width:s})},hideProgress:function(){r.innerHTML=r.oldhtml}})}},updateIndexer:function(r){cur.scrollList.cache.groups={all:[]};var s=cur.scrollList.cache.groups;for(var e in r)r.hasOwnProperty(e)&&s.all.push(e);cur.scrollList.index.groups=new vkIndexer(s.all,function(s){return r[s][0]})},rejectAll:function(r,s){showFastBox(getLang("global_warning"),getLang("groups_sure_reject_all"),getLang("groups_reject_all_inv"),function(r){ajax.post("/al_groups.php",{act:"reject_all",hash:s},{showProgress:lockButton.pbind(r),hideProgress:unlockButton.pbind(r)})},getLang("global_cancel"))},scrollCheck:function(){if(!browser.mobile&&cur.scrollList){var r=ge("ui_"+cur.scrollList.tab+"_load_more"),s=ge("ui_search_load_more");if(isVisible(r)||(r=s,isVisible(r))){var e=document.documentElement,t=window.innerHeight||e.clientHeight||bodyNode.clientHeight,o=scrollGetY();(o+t>r.offsetTop||cur.searchOffset&&o+2*t>r.offsetTop)&&this.showMore()}}},initScroll:function(){var r=this;this.destroyScroll(),this._scrollCheck=function(){return r.scrollCheck()},addEvent(window,"scroll",this._scrollCheck),addEvent(window,"resize",this._scrollCheck)},destroyScroll:function(){removeEvent(window,"scroll",this._scrollCheck),removeEvent(window,"resize",this._scrollCheck)},locNav:function(r,s,e){var t=r.tab,o=t||("events"==e.act?"future":"groups");if(delete r.tab,isEmpty(r)&&void 0!==t)return hide("groups_list_tab_"+cur.scrollList.tab),this.updateSummary(cur.scrollList.counts[cur.scrollList.tab]),cur.scrollList.tab=o,cur.scrollList.summary=geByClass1("ui_tab_count",ge("groups_"+o+"_tab")),show("groups_list_tab_"+o),checkPageBlocks(),nav.setLoc(e),window.uiSearch&&uiSearch.reset(cur.scrollList.query,!0),elfocus(cur.scrollList.query),this.updateSummary(cur.scrollList.counts[o]),cur.scrollList.offset=ge("groups_list_"+o).childNodes.length,this.showMore(!0),window.uiTabs&&uiTabs.hideProgress(ge("groups_"+o+"_tab")),!1},init:function(r){var s=this;extend(cur,{module:"groups_list",_back:{text:getLang("groups_back_to_list"),show:[function(){return s.initScroll},elfocus.pbind("groups_list_search")],hide:[function(){return s.destroyScroll}]},scrollList:{tab:r.tab,url:"al_groups.php",params:{act:"get_list",mid:r.mid},prefix:"groups_list_",query:ge("groups_list_search"),queryCont:gpeByClass("_wrap",ge("groups_list_search")),queryWrap:ge("group_u_search_input_wrap"),summary:geByClass1("ui_tab_count",ge("groups_"+(r.tab||"groups")+"_tab")),searchSummary:ge("groups_search_summary"),invites:ge("groups_invites_wrap"),invitesPreload:ge("groups_invites_preload"),invitesMoreLnk:ge("ui_invites_load_more"),searchWrap:ge("groups_list_search_wrap"),searchCont:ge("groups_list_search_cont"),eventsPopular:ge("events_popular_list"),perpage:20,offset:ge("groups_list_"+r.tab).childNodes.length,lists:{},cache:{},index:{},deleted:{},processed:{groups:{},admin:{},inv:{},future:{},past:{},events_concerts:{}},filtered:{},queries:{},counts:r.counts,genEmpty:r.genEmpty,genRow:r.genRow,genSummary:r.genSummary,genGroupsSummary:r.genGroupsSummary,invShown:r.invShown},filter:r.filter}),setTimeout(elfocus.pbind(cur.scrollList.query),0),cur.nav.push(function(){return s.locNav}),setTimeout(function(){return s.load},0),vk.version?addEvent(window,"load",function(){return s.initScroll}):this.initScroll(),cur.destroy.push(function(r){r==cur&&s.destroyScroll()})},updateSummary:function(r,s){val(s?cur.scrollList.searchSummary:cur.scrollList.summary,r?langNumeric(r,"%s",!0):"")},load:function(r,s){var e=this,t=s||cur.scrollList.tab;if(!cur.scrollList.lists[t]){var o=this.rand(),i=this.rand();cur.scrollList[o]=i,cur.scrollList.lists[t]="loading",ajax.post(cur.scrollList.url,extend(cur.scrollList.params,{tab:t}),{onDone:function(s){if(cur.scrollList&&cur.scrollList[o]==i){var c="update"==cur.scrollList.lists[t];if(c||"loading"==cur.scrollList.lists[t]){cur.scrollList.cache[t]={all:[]};for(var n=cur.scrollList.processed[t],l=0,a=s.length;l<a;++l){var u=n[s[l][2]];u&&(s[l][1]=u),cur.scrollList.cache[t].all.push(l)}cur.scrollList.indexing||(cur.scrollList.indexing={}),cur.scrollList.indexing[t]=!0,cur.scrollList.lists[t]=s;var h=c?function(){cur.scrollList&&cur.scrollList[o]==i&&cur.scrollList.tab==t&&e.showMore(r)}:function(){};cur.scrollList.index[t]=new vkIndexer(cur.scrollList.cache[t].all,function(r){return delete cur.scrollList.indexing[t],cur.scrollList.lists[t][r][0]},h)}}},local:1})}},getHighlight:function(r){var s=cur.scrollList.index[cur.scrollList.tab],e=s.delimiter,t=s.trimmer;return r+=" "+(parseLatin(r)||""),r=(r=escapeRE(r).replace(/&/g,"&amp;")).replace(t,"").replace(e,"|").replace(/(^\||\|$)/g,""),{re:new RegExp("("+r+")","gi"),val:'<span class="highlight">$1</span>'}},onSearchChange:function(r,s){delete cur.exactSearch,this.showMore(!1)},onSearchEnter:function(r,s){cur.exactSearch=1,this.showMore(!0)},showMore:function(r){var s=cur.scrollList.tab,e=cur.scrollList.lists[s];if(!e||"loading"==e||"update"==e)return e||this.load(r),void(cur.scrollList.lists[s]="update");if(!cur.scrollList.indexing||!cur.scrollList.indexing[s]){s=cur.scrollList.tab,e=cur.scrollList.cache[s].all;var o=trim(cur.scrollList.query.value);cur.searchStr=o,void 0===cur.scrollList.queries[s]&&(cur.scrollList.queries[s]="");var i=r||o!=cur.scrollList.queries[s];if(i||!1!==r){cur.scrollList.queries[s]=o;var c=!1;if(o){if(void 0===(e=cur.scrollList.cache[s]["_"+o])){var n=cur.scrollList.index[s].search(o),l={};e=[];for(var a=0,u=n.length;a<u;++a)l[n[a]]||(l[n[a]]=!0,e.push(n[a]));e.sort(function(r,s){return r-s}),cur.scrollList.cache[s]["_"+o]=e}c=this.getHighlight(o)}var h=e.length,d=ge(cur.scrollList.prefix+s),p=ge("ui_"+s+"_load_more");if(this.updateSummary(h),o&&h&&i&&Object(t.c)("groups",0,h,o),!h)return d.innerHTML=cur.scrollList.genEmpty(o),void(o&&this.needSearch(s)?i?(this.serverSearch(d,o),hide(p)):cur.searchOffset&&this.serverSearchMore(d,o):(hide(p),hide(cur.scrollList.searchWrap),show(cur.scrollList.eventsPopular),cur.searchOffset=0));for(var g=i?0:cur.scrollList.offset,f=Math.min(h,g+cur.scrollList.perpage),v=[],L=g;L<f;++L){var _=cur.scrollList.lists[s][e[L]];if(_){var m=_[0];c&&(m=m.replace(c.re,c.val)),v.push(cur.scrollList.genRow(_,m))}}if(o||g&&!i||(hide(cur.scrollList.searchWrap),show(cur.scrollList.eventsPopular),cur.searchOffset=0),i)if(hasClass(cur.scrollList.queryCont,"ui_search_fixed")&&scrollToY(getXY(cur.scrollList.queryWrap)[1]+1,0),d.innerHTML=v.join(""),checkPageBlocks(),cur.searchOffset=!1,e.length<5&&o&&this.needSearch(s)){var w=[],b=void 0;for(var x in e)e.hasOwnProperty(x)&&(b=cur.scrollList.lists[s][e[x]],w.push(b[2]));this.serverSearch(d,o,w)}else hide(cur.scrollList.searchWrap),show(cur.scrollList.eventsPopular),cur.searchOffset=0;else d.innerHTML+=v.join(""),cur.searchOffset&&this.serverSearchMore(d,o);cur.scrollList.offset=f,cur.searchOffset||(f<h?show:hide)(p)}}},showMoreInvites:function(r){if(!cur.loadingInvites){for(var s=cur.scrollList.invites&&geByClass1("groups_list",cur.scrollList.invites),e=cur.scrollList.invitesPreload,t=cur.scrollList.invitesMoreLnk;domFC(e);)s.appendChild(domFC(e)),cur.scrollList.invShown++;toggle(t,cur.scrollList.counts.invite>cur.scrollList.invShown),isVisible(t)&&ajax.post("/al_groups.php",{act:"more_invites",offset:cur.scrollList.invShown},{onDone:function(r,s){e.innerHTML=r,s&&(cur.scrollList.counts.invite-=s)},showProgress:function(){cur.loadingInvites=!0},hideProgress:function(){cur.loadingInvites=!1}})}},serverSearchMore:function(r,s){if(!cur.searchLoadingMore){cur.searchLoadingMore=1;var e=ge("ui_search_load_more");ajax.post("/al_groups.php",{act:"server_search",q:s,offset:cur.searchOffset,exact:cur.exactSearch,exclude:cur.searchExclude.join(",")},{onDone:function(r,s,e){cur.searchLoadingMore=0,r?(cur.searchOffset=e,cur.scrollList.searchCont.appendChild(cf(s))):cur.searchOffset=0,(!s||e>=r?hide:show)("ui_search_load_more")},onFail:function(){cur.searchLoadingMore=0},showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e)})}},extendedSearch:function(r){clearTimeout(cur.searchTimeout),cur.searchTimeout=setTimeout(function(){var s=geByClass1("groups_section_search");window.searcher&&s?hasClass(s,"ui_rmenu_item_sel")?searcher.onEnter():(uiRightMenu.switchMenu(s),uiRightMenu.showProgress(s),nav.go(s.href+"&c[like_hints]=1&c[q]="+r)):nav.go("/groups?act=catalog&c[q]="+r)},500)},onExtendedSearchChange:function(r,s){val("c[like_hints]",1),this.extendedSearch(r)},onExtendedSearchEnter:function(r,s,e){val("c[like_hints]",""),this.extendedSearch(s)},needSearch:function(r){return"groups"==r||"future"==r||"past"==r},serverSearch:function(r,s,e){var o=this;if(!this.needSearch(cur.scrollList.tab))return!1;clearTimeout(cur.searchTimeout),cur.searchTimeout=setTimeout(function(){if(cur.searchStr==s){cur.searchExclude=e||[];var r=+new Date;ajax.post("/al_groups.php",{act:"server_search",q:s,exact:cur.exactSearch,exclude:cur.searchExclude.join(",")},{onDone:function(e,i,c){cur.searchStr==s&&(!s||cur.searchExclude&&cur.searchExclude.length||Object(t.c)("groups",r,e,s),e?(cur.scrollList.searchCont.innerHTML=i,show(cur.scrollList.searchWrap),hide(cur.scrollList.eventsPopular),(c<e||!i)&&show("ui_search_load_more")):(cur.scrollList.searchCont.innerHTML="",hide(cur.scrollList.searchWrap),show(cur.scrollList.eventsPopular)),checkPageBlocks(),o.updateSummary(e,!0),cur.searchOffset=c)},showProgress:uiSearch.showProgress.pbind(cur.scrollList.query),hideProgress:uiSearch.hideProgress.pbind(cur.scrollList.query)})}},300)},showMapBox:function(r,s,e){var t=this;window.showZeroZoneBox&&showZeroZoneBox("places",function(){t.showMapBox(r,s,e)})||showTabbedBox("/al_places.php",{act:"show_photo_place",place_id:r},{stat:["places.css","map.css","maps.js","ui_controls.css","ui_controls.js"]})},feedbanGroup:function(r,s,e){var t=this,o=-s;ajax.post("/al_fans.php",{act:"feedtgl",oid:o,hash:e},{onDone:function(e,o){r.innerHTML=o,t.updateGroupField(s,9,e)},showProgress:function(){r.innerHTML='<span class="progress_inline"></span>'}})}};try{stManager.done(jsc("web/groups_list.js"))}catch(r){}},95:function(r,s,e){r.exports=e("4HDr")}});